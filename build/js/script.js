$(function(){var t=!0;$(".switch-button").on("click",function(o){o.preventDefault(),$("input").val(""),t?(t=!1,$(".register").show("slow"),$(".login").hide()):(t=!0,$(".login").show("slow"),$(".register").hide())}),$("input").on("focus",function(){$("p.error").remove(),$("input").removeClass("error")}),$(".register-button").on("click",function(o){o.preventDefault();var t={login:$("#register-login").val(),password:$("#register-password").val(),passwordConfirm:$("#register-password-confirm").val()};$.ajax({type:"POST",data:JSON.stringify(t),contentType:"application/json",url:"/api/auth/register"}).done(function(o){o.ok?$(".register h2").after('<p class="success">Отлично!</p>'):($(".register h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("input[name="+o+"]").addClass("error")}))})}),$(".login-button").on("click",function(o){o.preventDefault(),$("p.error").remove(),$("input").removeClass("error");var t={login:$("#login-login").val(),password:$("#login-password").val()};$.ajax({type:"POST",data:JSON.stringify(t),contentType:"application/json",url:"/api/auth/login"}).done(function(o){o.ok?$(location).attr("href","/"):($(".login h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("input[name="+o+"]").addClass("error")}))})})}),console.log("first * second"),console.log("Hello"),$(function(){function n(){$(".post-form p.error").remove(),$(".post-form input, #post-body").removeClass("error")}$(".post-form input, #post-body").on("focus",function(){n()}),$(".publish-button, .save-button").on("click",function(o){o.preventDefault(),n();var t="save-button"===$(this).attr("class").split(" ")[0],e={title:$("#post-title").val(),body:$("#post-body").val(),isDraft:t,postId:$("#post-id").val()};$.ajax({type:"POST",data:JSON.stringify(e),contentType:"application/json",url:"/post/add"}).done(function(o){console.log(o),o.ok?t?$(location).attr("href","/post/edit/"+o.post.id):$(location).attr("href","/posts/"+o.post.url):($(".post-form h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("#post-"+o).addClass("error")}))})}),$("#file").on("change",function(){var o=new FormData;o.append("postId",$("#post-id").val()),o.append("file",$("#file")[0].files[0]),$.ajax({type:"POST",url:"/upload/image",data:o,processData:!1,contentType:!1,success:function(o){console.log(o),$("#fileinfo").prepend('<div class="img-container"><img src="'+o.filePath+'" alt="" /></div><div class="del_photo">X</div>')},error:function(o){console.log(o)}})}),$(".del_photo").on("click",function(){var t="#"+$(this).parent().attr("id");console.log(t);var o={photo:$(this).parent().find("img").data("id"),post:$("#post-id").val(),path:$(this).parent().find("img").attr("src")};$.ajax({type:"POST",url:"/delete/image",data:JSON.stringify(o),contentType:"application/json",success:function(o){console.log(o),$(t).remove()},error:function(o){}})}),$(".DeletePost").on("click",function(){var o={postId:$("#post-id").val()};$.ajax({type:"POST",url:"/delete/post",data:JSON.stringify(o),contentType:"application/json",success:function(o){console.log(o)},error:function(){}})})}),$(function(){var n,r;function t(o,t){if($(".reply").show(),n&&n.remove(),r=null,n=$(".comment").clone(!0,!0),o)n.find(".cancel").hide(),n.appendTo(".comment-list");else{var e=$(t).parent();r=e.attr("id"),$(t).after(n)}n.css({display:"flex"})}t(!0),$(".reply").on("click",function(){t(!1,this),$(this).hide()}),$("form.comment .cancel").on("click",function(o){o.preventDefault(),n.remove(),t(!0)}),$("form.comment .send").on("click",function(o){o.preventDefault();var t={post:$(".comments").attr("id"),body:n.find("textarea").val(),parent:r};$.ajax({type:"POST",data:JSON.stringify(t),contentType:"application/json",url:"/comment/add"}).done(function(o){if(console.log(o),o.ok){var t='<ul><li style="background-color:#ffffe0;"><div class="head"><a href="/users/'+o.login+'">'+o.login+'</a><spam class="date">Только что</spam></div>'+o.body+"</li></ul>";$(n).after(t)}else void 0===o.error&&(o.error="Неизвестная ошибка!"),$(n).prepend('<p class="error">'+o.error+"</p>")})})});